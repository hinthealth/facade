(function(){function n(n,e,t){t=(t||0)-1;for(var r=n?n.length:0;++t<r;)if(n[t]===e)return t;return-1}function e(e,t){var r=typeof t;if(e=e.l,"boolean"==r||null==t)return e[t]?0:-1;"number"!=r&&"string"!=r&&(r="object");var u="number"==r?t:m+t;return e=(e=e[r])&&e[u],"object"==r?e&&-1<n(e,t)?0:-1:e?0:-1}function t(n){var e=this.l,t=typeof n;if("boolean"==t||null==n)e[n]=!0;else{"number"!=t&&"string"!=t&&(t="object");var r="number"==t?n:m+n,e=e[t]||(e[t]={});"object"==t?(e[r]||(e[r]=[])).push(n):e[r]=!0}}function r(n){return n.charCodeAt(0)}function u(n,e){for(var t=n.m,r=e.m,u=-1,o=t.length;++u<o;){var i=t[u],a=r[u];if(i!==a){if(i>a||"undefined"==typeof i)return 1;if(a>i||"undefined"==typeof a)return-1}}return n.n-e.n}function o(n){var e=-1,r=n.length,u=n[0],o=n[r/2|0],i=n[r-1];if(u&&"object"==typeof u&&o&&"object"==typeof o&&i&&"object"==typeof i)return!1;for(u=c(),u["false"]=u["null"]=u["true"]=u.undefined=!1,o=c(),o.k=n,o.l=u,o.push=t;++e<r;)o.push(n[e]);return o}function i(n){return"\\"+U[n]}function a(){return d.pop()||[]}function c(){return g.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,o:null}}function f(n){n.length=0,d.length<b&&d.push(n)}function l(n){var e=n.l;e&&l(e),n.k=n.l=n.m=n.object=n.number=n.string=n.o=null,g.length<b&&g.push(n)}function s(n,e,t){e||(e=0),"undefined"==typeof t&&(t=n?n.length:0);var r=-1;t=t-e||0;for(var u=Array(0>t?0:t);++r<t;)u[r]=n[e+r];return u}function p(t){function d(n,e,t){if(!n||!L[typeof n])return n;e=e&&"undefined"==typeof t?e:ee(e,t,3);for(var r=-1,u=L[typeof n]&&Pt(n),o=u?u.length:0;++r<o&&(t=u[r],!1!==e(n[t],t,n)););return n}function g(n,e,t){var r;if(!n||!L[typeof n])return n;e=e&&"undefined"==typeof t?e:ee(e,t,3);for(r in n)if(!1===e(n[r],r,n))break;return n}function b(n,e,t){var r,u=n,o=u;if(!u)return o;for(var i=arguments,a=0,c="number"==typeof t?2:i.length;++a<c;)if((u=i[a])&&L[typeof u])for(var f=-1,l=L[typeof u]&&Pt(u),s=l?l.length:0;++f<s;)r=l[f],"undefined"==typeof o[r]&&(o[r]=u[r]);return o}function U(n,e,t){var r,u=n,o=u;if(!u)return o;var i=arguments,a=0,c="number"==typeof t?2:i.length;if(c>3&&"function"==typeof i[c-2])var f=ee(i[--c-1],i[c--],2);else c>2&&"function"==typeof i[c-1]&&(f=i[--c]);for(;++a<c;)if((u=i[a])&&L[typeof u])for(var l=-1,s=L[typeof u]&&Pt(u),p=s?s.length:0;++l<p;)r=s[l],o[r]=f?f(o[r],u[r]):u[r];return o}function H(n){var e,t=[];if(!n||!L[typeof n])return t;for(e in n)mt.call(n,e)&&t.push(e);return t}function M(n){return n&&"object"==typeof n&&!Dt(n)&&mt.call(n,"__wrapped__")?n:new V(n)}function V(n,e){this.__chain__=!!e,this.__wrapped__=n}function Q(n){function e(){if(r){var n=s(r);yt.apply(n,arguments)}if(this instanceof e){var o=ne(t.prototype),n=t.apply(o,n||arguments);return we(n)?n:o}return t.apply(u,n||arguments)}var t=n[0],r=n[2],u=n[4];return It(e,n),e}function Z(n,e,t,r,u){if(t){var o=t(n);if("undefined"!=typeof o)return o}if(!we(n))return n;var i=lt.call(n);if(!z[i])return n;var c=Nt[i];switch(i){case D:case P:return new c(+n);case W:case K:return new c(n);case B:return o=c(n.source,F.exec(n)),o.lastIndex=n.lastIndex,o}if(i=Dt(n),e){var l=!r;r||(r=a()),u||(u=a());for(var p=r.length;p--;)if(r[p]==n)return u[p];o=i?c(n.length):{}}else o=i?s(n):U({},n);return i&&(mt.call(n,"index")&&(o.index=n.index),mt.call(n,"input")&&(o.input=n.input)),e?(r.push(n),u.push(o),(i?Re:d)(n,function(n,i){o[i]=Z(n,e,t,r,u)}),l&&(f(r),f(u)),o):o}function ne(n){return we(n)?Et(n):{}}function ee(n,e,t){if("function"!=typeof n)return Ue;if("undefined"==typeof e||!("prototype"in n))return n;var r=n.__bindData__;if("undefined"==typeof r&&(At.funcNames&&(r=!n.name),r=r||!At.funcDecomp,!r)){var u=gt.call(n);At.funcNames||(r=!O.test(u)),r||(r=T.test(u),It(n,r))}if(!1===r||!0!==r&&1&r[1])return n;switch(t){case 1:return function(t){return n.call(e,t)};case 2:return function(t,r){return n.call(e,t,r)};case 3:return function(t,r,u){return n.call(e,t,r,u)};case 4:return function(t,r,u,o){return n.call(e,t,r,u,o)}}return Ge(n,e)}function te(n){function e(){var n=c?i:this;if(u){var d=s(u);yt.apply(d,arguments)}return(o||l)&&(d||(d=s(arguments)),o&&yt.apply(d,o),l&&d.length<a)?(r|=16,te([t,p?r:-4&r,d,null,i,a])):(d||(d=arguments),f&&(t=n[h]),this instanceof e?(n=ne(t.prototype),d=t.apply(n,d),we(d)?d:n):t.apply(n,d))}var t=n[0],r=n[1],u=n[2],o=n[3],i=n[4],a=n[5],c=1&r,f=2&r,l=4&r,p=8&r,h=t;return It(e,n),e}function re(t,r){var u=-1,i=pe(),a=t?t.length:0,c=a>=y&&i===n,f=[];if(c){var s=o(r);s?(i=e,r=s):c=!1}for(;++u<a;)s=t[u],0>i(r,s)&&f.push(s);return c&&l(r),f}function ue(n,e,t,r){r=(r||0)-1;for(var u=n?n.length:0,o=[];++r<u;){var i=n[r];if(i&&"object"==typeof i&&"number"==typeof i.length&&(Dt(i)||ve(i))){e||(i=ue(i,e,t));var a=-1,c=i.length,f=o.length;for(o.length+=c;++a<c;)o[f++]=i[a]}else t||o.push(i)}return o}function oe(n,e,t,r,u,o){if(t){var i=t(n,e);if("undefined"!=typeof i)return!!i}if(n===e)return 0!==n||1/n==1/e;if(n===n&&!(n&&L[typeof n]||e&&L[typeof e]))return!1;if(null==n||null==e)return n===e;var c=lt.call(n),l=lt.call(e);if(c==A&&(c=$),l==A&&(l=$),c!=l)return!1;switch(c){case D:case P:return+n==+e;case W:return n!=+n?e!=+e:0==n?1/n==1/e:n==+e;case B:case K:return n==ot(e)}if(l=c==I,!l){var s=mt.call(n,"__wrapped__"),p=mt.call(e,"__wrapped__");if(s||p)return oe(s?n.__wrapped__:n,p?e.__wrapped__:e,t,r,u,o);if(c!=$)return!1;if(c=n.constructor,s=e.constructor,c!=s&&!(_e(c)&&c instanceof c&&_e(s)&&s instanceof s)&&"constructor"in n&&"constructor"in e)return!1}for(c=!u,u||(u=a()),o||(o=a()),s=u.length;s--;)if(u[s]==n)return o[s]==e;var h=0,i=!0;if(u.push(n),o.push(e),l){if(s=n.length,h=e.length,(i=h==s)||r)for(;h--;)if(l=s,p=e[h],r)for(;l--&&!(i=oe(n[l],p,t,r,u,o)););else if(!(i=oe(n[h],p,t,r,u,o)))break}else g(e,function(e,a,c){return mt.call(c,a)?(h++,i=mt.call(n,a)&&oe(n[a],e,t,r,u,o)):void 0}),i&&!r&&g(n,function(n,e,t){return mt.call(t,e)?i=-1<--h:void 0});return u.pop(),o.pop(),c&&(f(u),f(o)),i}function ie(n,e,t,r,u){(Dt(e)?Re:d)(e,function(e,o){var i,a,c=e,f=n[o];if(e&&((a=Dt(e))||Kt(e))){for(c=r.length;c--;)if(i=r[c]==e){f=u[c];break}if(!i){var l;t&&(c=t(f,e),l="undefined"!=typeof c)&&(f=c),l||(f=a?Dt(f)?f:[]:Kt(f)?f:{}),r.push(e),u.push(f),l||ie(f,e,t,r,u)}}else t&&(c=t(f,e),"undefined"==typeof c&&(c=e)),"undefined"!=typeof c&&(f=c);n[o]=f})}function ae(n,e){return n+dt(Ct()*(e-n+1))}function ce(t,r,u){var i=-1,c=pe(),s=t?t.length:0,p=[],h=!r&&s>=y&&c===n,d=u||h?a():p;for(h&&(d=o(d),c=e);++i<s;){var g=t[i],v=u?u(g,i,t):g;(r?!i||d[d.length-1]!==v:0>c(d,v))&&((u||h)&&d.push(v),p.push(g))}return h?(f(d.k),l(d)):u&&f(d),p}function fe(n){return function(e,t,r){var u={};t=M.createCallback(t,r,3),r=-1;var o=e?e.length:0;if("number"==typeof o)for(;++r<o;){var i=e[r];n(u,i,t(i,r,e),e)}else d(e,function(e,r,o){n(u,e,t(e,r,o),o)});return u}}function le(n,e,t,r,u,o){var i=1&e,a=4&e,c=16&e,f=32&e;if(!(2&e||_e(n)))throw new it;c&&!t.length&&(e&=-17,c=t=!1),f&&!r.length&&(e&=-33,f=r=!1);var l=n&&n.__bindData__;return l&&!0!==l?(l=s(l),l[2]&&(l[2]=s(l[2])),l[3]&&(l[3]=s(l[3])),!i||1&l[1]||(l[4]=u),!i&&1&l[1]&&(e|=8),!a||4&l[1]||(l[5]=o),c&&yt.apply(l[2]||(l[2]=[]),t),f&&wt.apply(l[3]||(l[3]=[]),r),l[1]|=e,le.apply(null,l)):(1==e||17===e?Q:te)([n,e,t,r,u,o])}function se(n){return Jt[n]}function pe(){var e=(e=M.indexOf)===We?n:e;return e}function he(n){return"function"==typeof n&&st.test(n)}function de(n){var e,t;return n&&lt.call(n)==$&&(e=n.constructor,!_e(e)||e instanceof e)?(g(n,function(n,e){t=e}),"undefined"==typeof t||mt.call(n,t)):!1}function ge(n){return Wt[n]}function ve(n){return n&&"object"==typeof n&&"number"==typeof n.length&&lt.call(n)==A||!1}function me(n,e,t){var r=Pt(n),u=r.length;for(e=ee(e,t,3);u--&&(t=r[u],!1!==e(n[t],t,n)););return n}function ye(n){var e=[];return g(n,function(n,t){_e(n)&&e.push(t)}),e.sort()}function be(n){for(var e=-1,t=Pt(n),r=t.length,u={};++e<r;){var o=t[e];u[n[o]]=o}return u}function _e(n){return"function"==typeof n}function we(n){return!(!n||!L[typeof n])}function ke(n){return"number"==typeof n||n&&"object"==typeof n&&lt.call(n)==W||!1}function Ee(n){return"string"==typeof n||n&&"object"==typeof n&&lt.call(n)==K||!1}function xe(n){for(var e=-1,t=Pt(n),r=t.length,u=Qe(r);++e<r;)u[e]=n[t[e]];return u}function Fe(n,e,t){var r=-1,u=pe(),o=n?n.length:0,i=!1;return t=(0>t?St(0,o+t):t)||0,Dt(n)?i=-1<u(n,e,t):"number"==typeof o?i=-1<(Ee(n)?n.indexOf(e,t):u(n,e,t)):d(n,function(n){return++r<t?void 0:!(i=n===e)}),i}function Oe(n,e,t){var r=!0;e=M.createCallback(e,t,3),t=-1;var u=n?n.length:0;if("number"==typeof u)for(;++t<u&&(r=!!e(n[t],t,n)););else d(n,function(n,t,u){return r=!!e(n,t,u)});return r}function je(n,e,t){var r=[];e=M.createCallback(e,t,3),t=-1;var u=n?n.length:0;if("number"==typeof u)for(;++t<u;){var o=n[t];e(o,t,n)&&r.push(o)}else d(n,function(n,t,u){e(n,t,u)&&r.push(n)});return r}function Se(n,e,t){e=M.createCallback(e,t,3),t=-1;var r=n?n.length:0;if("number"!=typeof r){var u;return d(n,function(n,t,r){return e(n,t,r)?(u=n,!1):void 0}),u}for(;++t<r;){var o=n[t];if(e(o,t,n))return o}}function Re(n,e,t){var r=-1,u=n?n.length:0;if(e=e&&"undefined"==typeof t?e:ee(e,t,3),"number"==typeof u)for(;++r<u&&!1!==e(n[r],r,n););else d(n,e);return n}function Te(n,e,t){var r=n?n.length:0;if(e=e&&"undefined"==typeof t?e:ee(e,t,3),"number"==typeof r)for(;r--&&!1!==e(n[r],r,n););else{var u=Pt(n),r=u.length;d(n,function(n,t,o){return t=u?u[--r]:--r,e(o[t],t,o)})}return n}function Ce(n,e,t){var r=-1,u=n?n.length:0;if(e=M.createCallback(e,t,3),"number"==typeof u)for(var o=Qe(u);++r<u;)o[r]=e(n[r],r,n);else o=[],d(n,function(n,t,u){o[++r]=e(n,t,u)});return o}function Ne(n,e,t){var u=-1/0,o=u;if("function"!=typeof e&&t&&t[e]===n&&(e=null),null==e&&Dt(n)){t=-1;for(var i=n.length;++t<i;){var a=n[t];a>o&&(o=a)}}else e=null==e&&Ee(n)?r:M.createCallback(e,t,3),Re(n,function(n,t,r){t=e(n,t,r),t>u&&(u=t,o=n)});return o}function Ae(n,e,t,r){if(!n)return t;var u=3>arguments.length;e=M.createCallback(e,r,4);var o=-1,i=n.length;if("number"==typeof i)for(u&&(t=n[++o]);++o<i;)t=e(t,n[o],o,n);else d(n,function(n,r,o){t=u?(u=!1,n):e(t,n,r,o)});return t}function Ie(n,e,t,r){var u=3>arguments.length;return e=M.createCallback(e,r,4),Te(n,function(n,r,o){t=u?(u=!1,n):e(t,n,r,o)}),t}function De(n){var e=-1,t=n?n.length:0,r=Qe("number"==typeof t?t:0);return Re(n,function(n){var t=ae(0,++e);r[e]=r[t],r[t]=n}),r}function Pe(n,e,t){var r;e=M.createCallback(e,t,3),t=-1;var u=n?n.length:0;if("number"==typeof u)for(;++t<u&&!(r=e(n[t],t,n)););else d(n,function(n,t,u){return!(r=e(n,t,u))});return!!r}function Je(n,e,t){var r=0,u=n?n.length:0;if("number"!=typeof e&&null!=e){var o=-1;for(e=M.createCallback(e,t,3);++o<u&&e(n[o],o,n);)r++}else if(r=e,null==r||t)return n?n[0]:h;return s(n,0,Rt(St(0,r),u))}function We(e,t,r){if("number"==typeof r){var u=e?e.length:0;r=0>r?St(0,u+r):r||0}else if(r)return r=Be(e,t),e[r]===t?r:-1;return n(e,t,r)}function $e(n,e,t){if("number"!=typeof e&&null!=e){var r=0,u=-1,o=n?n.length:0;for(e=M.createCallback(e,t,3);++u<o&&e(n[u],u,n);)r++}else r=null==e||t?1:St(0,e);return s(n,r)}function Be(n,e,t,r){var u=0,o=n?n.length:u;for(t=t?M.createCallback(t,r,1):Ue,e=t(e);o>u;)r=u+o>>>1,t(n[r])<e?u=r+1:o=r;return u}function Ke(n,e,t,r){return"boolean"!=typeof e&&null!=e&&(r=t,t="function"!=typeof e&&r&&r[e]===n?null:e,e=!1),null!=t&&(t=M.createCallback(t,r,3)),ce(n,e,t)}function ze(){for(var n=1<arguments.length?arguments:arguments[0],e=-1,t=n?Ne(Lt(n,"length")):0,r=Qe(0>t?0:t);++e<t;)r[e]=Lt(n,e);return r}function qe(n,e){var t=-1,r=n?n.length:0,u={};for(e||!r||Dt(n[0])||(e=[]);++t<r;){var o=n[t];e?u[o]=e[t]:o&&(u[o[0]]=o[1])}return u}function Ge(n,e){return 2<arguments.length?le(n,17,s(arguments,2),null,e):le(n,1,null,null,e)}function Le(n,e,t){function r(){l&&ht(l),i=l=s=h,(g||d!==e)&&(p=Ut(),a=n.apply(f,o),l||i||(o=f=null))}function u(){var t=e-(Ut()-c);t>0?l=bt(u,t):(i&&ht(i),t=s,i=l=s=h,t&&(p=Ut(),a=n.apply(f,o),l||i||(o=f=null)))}var o,i,a,c,f,l,s,p=0,d=!1,g=!0;if(!_e(n))throw new it;if(e=St(0,e)||0,!0===t)var v=!0,g=!1;else we(t)&&(v=t.leading,d="maxWait"in t&&(St(e,t.maxWait)||0),g="trailing"in t?t.trailing:g);return function(){if(o=arguments,c=Ut(),f=this,s=g&&(l||!v),!1===d)var t=v&&!l;else{i||v||(p=c);var h=d-(c-p),m=0>=h;m?(i&&(i=ht(i)),p=c,a=n.apply(f,o)):i||(i=bt(r,h))}return m&&l?l=ht(l):l||e===d||(l=bt(u,e)),t&&(m=!0,a=n.apply(f,o)),!m||l||i||(o=f=null),a}}function Ue(n){return n}function Ye(n,e,t){var r=!0,u=e&&ye(e);e&&(t||u.length)||(null==t&&(t=e),o=V,e=n,n=M,u=ye(e)),!1===t?r=!1:we(t)&&"chain"in t&&(r=t.chain);var o=n,i=_e(o);Re(u,function(t){var u=n[t]=e[t];i&&(o.prototype[t]=function(){var e=this.__chain__,t=this.__wrapped__,i=[t];if(yt.apply(i,arguments),i=u.apply(n,i),r||e){if(t===i&&we(i))return this;i=new o(i),i.__chain__=e}return i})})}function He(){}function Me(n){return function(e){return e[n]}}function Ve(){return this.__wrapped__}t=t?X.defaults(Y.Object(),t,X.pick(Y,N)):Y;var Qe=t.Array,Xe=t.Boolean,Ze=t.Date,nt=t.Function,et=t.Math,tt=t.Number,rt=t.Object,ut=t.RegExp,ot=t.String,it=t.TypeError,at=[],ct=rt.prototype,ft=t._,lt=ct.toString,st=ut("^"+ot(lt).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),pt=et.ceil,ht=t.clearTimeout,dt=et.floor,gt=nt.prototype.toString,vt=he(vt=rt.getPrototypeOf)&&vt,mt=ct.hasOwnProperty,yt=at.push,bt=t.setTimeout,_t=at.splice,wt=at.unshift,kt=function(){try{var n={},e=he(e=rt.defineProperty)&&e,t=e(n,n,n)&&e}catch(r){}return t}(),Et=he(Et=rt.create)&&Et,xt=he(xt=Qe.isArray)&&xt,Ft=t.isFinite,Ot=t.isNaN,jt=he(jt=rt.keys)&&jt,St=et.max,Rt=et.min,Tt=t.parseInt,Ct=et.random,Nt={};Nt[I]=Qe,Nt[D]=Xe,Nt[P]=Ze,Nt[J]=nt,Nt[$]=rt,Nt[W]=tt,Nt[B]=ut,Nt[K]=ot,V.prototype=M.prototype;var At=M.support={};At.funcDecomp=!he(t.a)&&T.test(p),At.funcNames="string"==typeof nt.name,M.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:j,variable:"",imports:{_:M}},Et||(ne=function(){function n(){}return function(e){if(we(e)){n.prototype=e;var r=new n;n.prototype=null}return r||t.Object()}}());var It=kt?function(n,e){G.value=e,kt(n,"__bindData__",G)}:He,Dt=xt||function(n){return n&&"object"==typeof n&&"number"==typeof n.length&&lt.call(n)==I||!1},Pt=jt?function(n){return we(n)?jt(n):[]}:H,Jt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Wt=be(Jt),$t=ut("("+Pt(Wt).join("|")+")","g"),Bt=ut("["+Pt(Jt).join("")+"]","g"),Kt=vt?function(n){if(!n||lt.call(n)!=$)return!1;var e=n.valueOf,t=he(e)&&(t=vt(e))&&vt(t);return t?n==t||vt(n)==t:de(n)}:de,zt=fe(function(n,e,t){mt.call(n,t)?n[t]++:n[t]=1}),qt=fe(function(n,e,t){(mt.call(n,t)?n[t]:n[t]=[]).push(e)}),Gt=fe(function(n,e,t){n[t]=e}),Lt=Ce,Ut=he(Ut=Ze.now)&&Ut||function(){return(new Ze).getTime()},Yt=8==Tt(_+"08")?Tt:function(n,e){return Tt(Ee(n)?n.replace(S,""):n,e||0)};return M.after=function(n,e){if(!_e(e))throw new it;return function(){return 1>--n?e.apply(this,arguments):void 0}},M.assign=U,M.at=function(n){for(var e=arguments,t=-1,r=ue(e,!0,!1,1),e=e[2]&&e[2][e[1]]===n?1:r.length,u=Qe(e);++t<e;)u[t]=n[r[t]];return u},M.bind=Ge,M.bindAll=function(n){for(var e=1<arguments.length?ue(arguments,!0,!1,1):ye(n),t=-1,r=e.length;++t<r;){var u=e[t];n[u]=le(n[u],1,null,null,n)}return n},M.bindKey=function(n,e){return 2<arguments.length?le(e,19,s(arguments,2),null,n):le(e,3,null,null,n)},M.chain=function(n){return n=new V(n),n.__chain__=!0,n},M.compact=function(n){for(var e=-1,t=n?n.length:0,r=[];++e<t;){var u=n[e];u&&r.push(u)}return r},M.compose=function(){for(var n=arguments,e=n.length;e--;)if(!_e(n[e]))throw new it;return function(){for(var e=arguments,t=n.length;t--;)e=[n[t].apply(this,e)];return e[0]}},M.constant=function(n){return function(){return n}},M.countBy=zt,M.create=function(n,e){var t=ne(n);return e?U(t,e):t},M.createCallback=function(n,e,t){var r=typeof n;if(null==n||"function"==r)return ee(n,e,t);if("object"!=r)return Me(n);var u=Pt(n),o=u[0],i=n[o];return 1!=u.length||i!==i||we(i)?function(e){for(var t=u.length,r=!1;t--&&(r=oe(e[u[t]],n[u[t]],null,!0)););return r}:function(n){return n=n[o],i===n&&(0!==i||1/i==1/n)}},M.curry=function(n,e){return e="number"==typeof e?e:+e||n.length,le(n,4,null,null,null,e)},M.debounce=Le,M.defaults=b,M.defer=function(n){if(!_e(n))throw new it;var e=s(arguments,1);return bt(function(){n.apply(h,e)},1)},M.delay=function(n,e){if(!_e(n))throw new it;var t=s(arguments,2);return bt(function(){n.apply(h,t)},e)},M.difference=function(n){return re(n,ue(arguments,!0,!0,1))},M.filter=je,M.flatten=function(n,e,t,r){return"boolean"!=typeof e&&null!=e&&(r=t,t="function"!=typeof e&&r&&r[e]===n?null:e,e=!1),null!=t&&(n=Ce(n,t,r)),ue(n,e)},M.forEach=Re,M.forEachRight=Te,M.forIn=g,M.forInRight=function(n,e,t){var r=[];g(n,function(n,e){r.push(e,n)});var u=r.length;for(e=ee(e,t,3);u--&&!1!==e(r[u--],r[u],n););return n},M.forOwn=d,M.forOwnRight=me,M.functions=ye,M.groupBy=qt,M.indexBy=Gt,M.initial=function(n,e,t){var r=0,u=n?n.length:0;if("number"!=typeof e&&null!=e){var o=u;for(e=M.createCallback(e,t,3);o--&&e(n[o],o,n);)r++}else r=null==e||t?1:e||r;return s(n,0,Rt(St(0,u-r),u))},M.intersection=function(){for(var t=[],r=-1,u=arguments.length,i=a(),c=pe(),s=c===n,p=a();++r<u;){var h=arguments[r];(Dt(h)||ve(h))&&(t.push(h),i.push(s&&h.length>=y&&o(r?t[r]:p)))}var s=t[0],d=-1,g=s?s.length:0,v=[];n:for(;++d<g;){var m=i[0],h=s[d];if(0>(m?e(m,h):c(p,h))){for(r=u,(m||p).push(h);--r;)if(m=i[r],0>(m?e(m,h):c(t[r],h)))continue n;v.push(h)}}for(;u--;)(m=i[u])&&l(m);return f(i),f(p),v},M.invert=be,M.invoke=function(n,e){var t=s(arguments,2),r=-1,u="function"==typeof e,o=n?n.length:0,i=Qe("number"==typeof o?o:0);return Re(n,function(n){i[++r]=(u?e:n[e]).apply(n,t)}),i},M.keys=Pt,M.map=Ce,M.mapValues=function(n,e,t){var r={};return e=M.createCallback(e,t,3),d(n,function(n,t,u){r[t]=e(n,t,u)}),r},M.max=Ne,M.memoize=function(n,e){function t(){var r=t.cache,u=e?e.apply(this,arguments):m+arguments[0];return mt.call(r,u)?r[u]:r[u]=n.apply(this,arguments)}if(!_e(n))throw new it;return t.cache={},t},M.merge=function(n){var e=arguments,t=2;if(!we(n))return n;if("number"!=typeof e[2]&&(t=e.length),t>3&&"function"==typeof e[t-2])var r=ee(e[--t-1],e[t--],2);else t>2&&"function"==typeof e[t-1]&&(r=e[--t]);for(var e=s(arguments,1,t),u=-1,o=a(),i=a();++u<t;)ie(n,e[u],r,o,i);return f(o),f(i),n},M.min=function(n,e,t){var u=1/0,o=u;if("function"!=typeof e&&t&&t[e]===n&&(e=null),null==e&&Dt(n)){t=-1;for(var i=n.length;++t<i;){var a=n[t];o>a&&(o=a)}}else e=null==e&&Ee(n)?r:M.createCallback(e,t,3),Re(n,function(n,t,r){t=e(n,t,r),u>t&&(u=t,o=n)});return o},M.omit=function(n,e,t){var r={};if("function"!=typeof e){var u=[];g(n,function(n,e){u.push(e)});for(var u=re(u,ue(arguments,!0,!1,1)),o=-1,i=u.length;++o<i;){var a=u[o];r[a]=n[a]}}else e=M.createCallback(e,t,3),g(n,function(n,t,u){e(n,t,u)||(r[t]=n)});return r},M.once=function(n){var e,t;if(!_e(n))throw new it;return function(){return e?t:(e=!0,t=n.apply(this,arguments),n=null,t)}},M.pairs=function(n){for(var e=-1,t=Pt(n),r=t.length,u=Qe(r);++e<r;){var o=t[e];u[e]=[o,n[o]]}return u},M.partial=function(n){return le(n,16,s(arguments,1))},M.partialRight=function(n){return le(n,32,null,s(arguments,1))},M.pick=function(n,e,t){var r={};if("function"!=typeof e)for(var u=-1,o=ue(arguments,!0,!1,1),i=we(n)?o.length:0;++u<i;){var a=o[u];a in n&&(r[a]=n[a])}else e=M.createCallback(e,t,3),g(n,function(n,t,u){e(n,t,u)&&(r[t]=n)});return r},M.pluck=Lt,M.property=Me,M.pull=function(n){for(var e=arguments,t=0,r=e.length,u=n?n.length:0;++t<r;)for(var o=-1,i=e[t];++o<u;)n[o]===i&&(_t.call(n,o--,1),u--);return n},M.range=function(n,e,t){n=+n||0,t="number"==typeof t?t:+t||1,null==e&&(e=n,n=0);var r=-1;e=St(0,pt((e-n)/(t||1)));for(var u=Qe(e);++r<e;)u[r]=n,n+=t;return u},M.reject=function(n,e,t){return e=M.createCallback(e,t,3),je(n,function(n,t,r){return!e(n,t,r)})},M.remove=function(n,e,t){var r=-1,u=n?n.length:0,o=[];for(e=M.createCallback(e,t,3);++r<u;)t=n[r],e(t,r,n)&&(o.push(t),_t.call(n,r--,1),u--);return o},M.rest=$e,M.shuffle=De,M.sortBy=function(n,e,t){var r=-1,o=Dt(e),i=n?n.length:0,s=Qe("number"==typeof i?i:0);for(o||(e=M.createCallback(e,t,3)),Re(n,function(n,t,u){var i=s[++r]=c();o?i.m=Ce(e,function(e){return n[e]}):(i.m=a())[0]=e(n,t,u),i.n=r,i.o=n}),i=s.length,s.sort(u);i--;)n=s[i],s[i]=n.o,o||f(n.m),l(n);return s},M.tap=function(n,e){return e(n),n},M.throttle=function(n,e,t){var r=!0,u=!0;if(!_e(n))throw new it;return!1===t?r=!1:we(t)&&(r="leading"in t?t.leading:r,u="trailing"in t?t.trailing:u),q.leading=r,q.maxWait=e,q.trailing=u,Le(n,e,q)},M.times=function(n,e,t){n=-1<(n=+n)?n:0;var r=-1,u=Qe(n);for(e=ee(e,t,1);++r<n;)u[r]=e(r);return u},M.toArray=function(n){return n&&"number"==typeof n.length?s(n):xe(n)},M.transform=function(n,e,t,r){var u=Dt(n);if(null==t)if(u)t=[];else{var o=n&&n.constructor;t=ne(o&&o.prototype)}return e&&(e=M.createCallback(e,r,4),(u?Re:d)(n,function(n,r,u){return e(t,n,r,u)})),t},M.union=function(){return ce(ue(arguments,!0,!0))},M.uniq=Ke,M.values=xe,M.where=je,M.without=function(n){return re(n,s(arguments,1))},M.wrap=function(n,e){return le(e,16,[n])},M.xor=function(){for(var n=-1,e=arguments.length;++n<e;){var t=arguments[n];if(Dt(t)||ve(t))var r=r?ce(re(r,t).concat(re(t,r))):t}return r||[]},M.zip=ze,M.zipObject=qe,M.collect=Ce,M.drop=$e,M.each=Re,M.eachRight=Te,M.extend=U,M.methods=ye,M.object=qe,M.select=je,M.tail=$e,M.unique=Ke,M.unzip=ze,Ye(M),M.clone=function(n,e,t,r){return"boolean"!=typeof e&&null!=e&&(r=t,t=e,e=!1),Z(n,e,"function"==typeof t&&ee(t,r,1))},M.cloneDeep=function(n,e,t){return Z(n,!0,"function"==typeof e&&ee(e,t,1))},M.contains=Fe,M.escape=function(n){return null==n?"":ot(n).replace(Bt,se)},M.every=Oe,M.find=Se,M.findIndex=function(n,e,t){var r=-1,u=n?n.length:0;for(e=M.createCallback(e,t,3);++r<u;)if(e(n[r],r,n))return r;return-1},M.findKey=function(n,e,t){var r;return e=M.createCallback(e,t,3),d(n,function(n,t,u){return e(n,t,u)?(r=t,!1):void 0}),r},M.findLast=function(n,e,t){var r;return e=M.createCallback(e,t,3),Te(n,function(n,t,u){return e(n,t,u)?(r=n,!1):void 0}),r},M.findLastIndex=function(n,e,t){var r=n?n.length:0;for(e=M.createCallback(e,t,3);r--;)if(e(n[r],r,n))return r;return-1},M.findLastKey=function(n,e,t){var r;return e=M.createCallback(e,t,3),me(n,function(n,t,u){return e(n,t,u)?(r=t,!1):void 0}),r},M.has=function(n,e){return n?mt.call(n,e):!1},M.identity=Ue,M.indexOf=We,M.isArguments=ve,M.isArray=Dt,M.isBoolean=function(n){return!0===n||!1===n||n&&"object"==typeof n&&lt.call(n)==D||!1},M.isDate=function(n){return n&&"object"==typeof n&&lt.call(n)==P||!1},M.isElement=function(n){return n&&1===n.nodeType||!1},M.isEmpty=function(n){var e=!0;if(!n)return e;var t=lt.call(n),r=n.length;return t==I||t==K||t==A||t==$&&"number"==typeof r&&_e(n.splice)?!r:(d(n,function(){return e=!1}),e)},M.isEqual=function(n,e,t,r){return oe(n,e,"function"==typeof t&&ee(t,r,2))},M.isFinite=function(n){return Ft(n)&&!Ot(parseFloat(n))},M.isFunction=_e,M.isNaN=function(n){return ke(n)&&n!=+n},M.isNull=function(n){return null===n},M.isNumber=ke,M.isObject=we,M.isPlainObject=Kt,M.isRegExp=function(n){return n&&"object"==typeof n&&lt.call(n)==B||!1},M.isString=Ee,M.isUndefined=function(n){return"undefined"==typeof n},M.lastIndexOf=function(n,e,t){var r=n?n.length:0;for("number"==typeof t&&(r=(0>t?St(0,r+t):Rt(t,r-1))+1);r--;)if(n[r]===e)return r;return-1},M.mixin=Ye,M.noConflict=function(){return t._=ft,this},M.noop=He,M.now=Ut,M.parseInt=Yt,M.random=function(n,e,t){var r=null==n,u=null==e;return null==t&&("boolean"==typeof n&&u?(t=n,n=1):u||"boolean"!=typeof e||(t=e,u=!0)),r&&u&&(e=1),n=+n||0,u?(e=n,n=0):e=+e||0,t||n%1||e%1?(t=Ct(),Rt(n+t*(e-n+parseFloat("1e-"+((t+"").length-1))),e)):ae(n,e)},M.reduce=Ae,M.reduceRight=Ie,M.result=function(n,e){if(n){var t=n[e];return _e(t)?n[e]():t}},M.runInContext=p,M.size=function(n){var e=n?n.length:0;return"number"==typeof e?e:Pt(n).length},M.some=Pe,M.sortedIndex=Be,M.template=function(n,e,t){var r=M.templateSettings;n=ot(n||""),t=b({},t,r);var u,o=b({},t.imports,r.imports),r=Pt(o),o=xe(o),a=0,c=t.interpolate||R,f="__p+='",c=ut((t.escape||R).source+"|"+c.source+"|"+(c===j?x:R).source+"|"+(t.evaluate||R).source+"|$","g");n.replace(c,function(e,t,r,o,c,l){return r||(r=o),f+=n.slice(a,l).replace(C,i),t&&(f+="'+__e("+t+")+'"),c&&(u=!0,f+="';"+c+";\n__p+='"),r&&(f+="'+((__t=("+r+"))==null?'':__t)+'"),a=l+e.length,e}),f+="';",c=t=t.variable,c||(t="obj",f="with("+t+"){"+f+"}"),f=(u?f.replace(w,""):f).replace(k,"$1").replace(E,"$1;"),f="function("+t+"){"+(c?"":t+"||("+t+"={});")+"var __t,__p='',__e=_.escape"+(u?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+f+"return __p}";try{var l=nt(r,"return "+f).apply(h,o)}catch(s){throw s.source=f,s}return e?l(e):(l.source=f,l)},M.unescape=function(n){return null==n?"":ot(n).replace($t,ge)},M.uniqueId=function(n){var e=++v;return ot(null==n?"":n)+e},M.all=Oe,M.any=Pe,M.detect=Se,M.findWhere=Se,M.foldl=Ae,M.foldr=Ie,M.include=Fe,M.inject=Ae,Ye(function(){var n={};return d(M,function(e,t){M.prototype[t]||(n[t]=e)}),n}(),!1),M.first=Je,M.last=function(n,e,t){var r=0,u=n?n.length:0;if("number"!=typeof e&&null!=e){var o=u;for(e=M.createCallback(e,t,3);o--&&e(n[o],o,n);)r++}else if(r=e,null==r||t)return n?n[u-1]:h;return s(n,St(0,u-r))},M.sample=function(n,e,t){return n&&"number"!=typeof n.length&&(n=xe(n)),null==e||t?n?n[ae(0,n.length-1)]:h:(n=De(n),n.length=Rt(St(0,e),n.length),n)},M.take=Je,M.head=Je,d(M,function(n,e){var t="sample"!==e;M.prototype[e]||(M.prototype[e]=function(e,r){var u=this.__chain__,o=n(this.__wrapped__,e,r);return u||null!=e&&(!r||t&&"function"==typeof e)?new V(o,u):o})}),M.VERSION="2.4.1",M.prototype.chain=function(){return this.__chain__=!0,this},M.prototype.toString=function(){return ot(this.__wrapped__)},M.prototype.value=Ve,M.prototype.valueOf=Ve,Re(["join","pop","shift"],function(n){var e=at[n];M.prototype[n]=function(){var n=this.__chain__,t=e.apply(this.__wrapped__,arguments);return n?new V(t,n):t}}),Re(["push","reverse","sort","unshift"],function(n){var e=at[n];M.prototype[n]=function(){return e.apply(this.__wrapped__,arguments),this}}),Re(["concat","slice","splice"],function(n){var e=at[n];M.prototype[n]=function(){return new V(e.apply(this.__wrapped__,arguments),this.__chain__)}}),M}var h,d=[],g=[],v=0,m=+new Date+"",y=75,b=40,_=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",w=/\b__p\+='';/g,k=/\b(__p\+=)''\+/g,E=/(__e\(.*?\)|\b__t\))\+'';/g,x=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,F=/\w*$/,O=/^\s*function[ \n\r\t]+\w/,j=/<%=([\s\S]+?)%>/g,S=RegExp("^["+_+"]*0+(?=.$)"),R=/($^)/,T=/\bthis\b/,C=/['\n\r\t\u2028\u2029\\]/g,N="Array Boolean Date Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setTimeout".split(" "),A="[object Arguments]",I="[object Array]",D="[object Boolean]",P="[object Date]",J="[object Function]",W="[object Number]",$="[object Object]",B="[object RegExp]",K="[object String]",z={};z[J]=!1,z[A]=z[I]=z[D]=z[P]=z[W]=z[$]=z[B]=z[K]=!0;var q={leading:!1,maxWait:0,trailing:!1},G={configurable:!1,enumerable:!1,value:null,writable:!1},L={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},U={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},Y=L[typeof window]&&window||this,H=L[typeof exports]&&exports&&!exports.nodeType&&exports,M=L[typeof module]&&module&&!module.nodeType&&module,V=M&&M.exports===H&&H,Q=L[typeof global]&&global;!Q||Q.global!==Q&&Q.window!==Q||(Y=Q);var X=p();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Y._=X,define(function(){return X})):H&&M?V?(M.exports=X)._=X:H._=X:Y._=X}).call(this),function(){"use strict";function n(){$=_.clone(Facade.resources,!0),B=_.clone(Facade.db,!0),K=_.clone(W,!0)}function e(n){t(n),r(n)}function t(n){_.each(s(),function(e){var t={resource:n,method:e.method};e.createWith(t),g(t)})}function r(n){var e=E(n);_.each(e,function(e){u(n,e)})}function u(n,e){_.each(l(),function(t){var r={resource:n,item:e,method:t.method};t.createWith(r),g(r)}),_.each(z,function(n){n.item&&(n.item=e,p(n),g(n))})}function o(n){Facade.backend.whenGET(n.resource.url+"/"+n.item.id).respond(function(e,t){var r=Facade.findRoute(e,t),u=r.getSpecialResponseOr(function(){var e=x(n.resource,n.item.id);return[200,JSON.stringify(e),{},"OK"]});return u})}function i(n){Facade.backend.whenPUT(n.resource.url+"/"+n.item.id).respond(function(e,t,r,u){r=r||{};var o=Facade.findRoute(e,t),i=o.getSpecialResponseOr(function(){var e=x(n.resource,n.item.id);return _.assign(e,JSON.parse(r)),[200,JSON.stringify(e),u,"OK"]});return i})}function a(n){Facade.backend.whenDELETE(n.resource.url+"/"+n.item.id).respond(function(e,t,r){r=r||{};var u=Facade.findRoute(e,t),o=u.getSpecialResponseOr(function(){var e=k(n.resource).delete(n.item.id);return[200,JSON.stringify(e),{},"OK"]});return o})}function c(n){Facade.backend.whenPOST(n.resource.url).respond(function(e,t,r){r=r||{},r=JSON.parse(r);var u=Facade.findRoute(e,t),o=u.getSpecialResponseOr(function(){var e=_.isFunction(n.resource.createDefault)&&n.resource.createDefault(r);return e=e||r,n.resource.addItem(e),[200,JSON.stringify(e),{},"OK"]});return o})}function f(n){Facade.backend.whenGET(n.resource.url).respond(function(e,t){var r=Facade.findRoute(e,t),u=r.getSpecialResponseOr(function(){return[200,E(n.resource),{},"OK"]});return u})}function l(){return[{createWith:o,method:"GET"},{createWith:i,method:"PUT"},{createWith:a,method:"DELETE"}]}function s(){return[{createWith:c,method:"POST"},{createWith:f,method:"GET"}]}function p(n){A(n.route);var e=n.resource.url+"/"+n.item.id+n.route;Facade.backend.when(n.method,e).respond(function(e,t,r,u){r=r||{};var o=Facade.findRoute(e,t),i=k(n.resource).find(n.item.id),a=o.getSpecialResponseOr(function(){return n.callback(r,i,u)});return D(a),a})}function h(n){var e=_.isRegExp(n.route)?n.route:n.resource.url+n.route;Facade.backend.when(n.method,e).respond(function(e,t,r){r=r||{};var u=k(n.resource).getAll(),o=Facade.findRoute(e,t),i=o.getSpecialResponseOr(function(){return n.callback(r,u)});return D(i),i})}function d(n){var e=n.resource.url+n.route;Facade.backend.expect(n.method,e,m(n.expected)).respond(function(e,t,r){r=r||{};var u=k(n.resource).getAll(),o=Facade.findRoute(e,t);o.hasSpecialResponse()||_.isFunction(n.callback)&&n.callback(r,u);var i=o.getSpecialResponseOr(function(){return[200,JSON.stringify(u),{},"OK"]});return i})}function g(n){if(n.route=n.route||"",_.isRegExp(n.route))n.regExp=n.route;else{var e=n.resource.url,t=n.item?e+"/"+n.item.id+n.route:e+n.route,r=[n.method,t].join(" ");n.fullRoute=r}W[n.resource.name][n.regExp||n.fullRoute]=b(n)}function v(n){z.push(n)}function m(n){function e(t,r,u){if(t[u])return t[u]===r?!0:(console.log("Expected",u,"to equal",r,"in",t,"but it was",t[u]),!1);var o=_.filter(t,function(n){return _.isObject(n)}),i=t[u]===val;return o||i?_.any(o,function(n){return e(n,r,u)}):(console.log("Missing expectedKey",u,"in",nestedData,"should include",n),!1)}return function(t){var r=JSON.parse(t);return r?_.all(n,function(n,t){return e(r,n,t)}):(console.log("Unable to parse to JSON:",t),!1)}}function y(n){return n=n||{},n.url=this&&this.url?this.url+n.url:n.url,{url:n.url,name:n.name,addItem:function(n){return S(n),k(this).create(n),J&&u(this,n),n},addItems:function(n){T(n),_.each(n,function(n){this.addItem(n)},this)},resource:y,addRoute:function(n){if(n=n||{},I(n),n.resource=this,v(n),n.onItem){var e=k(this).getAll();_.each(e,function(e){n.item=e,p(n),g(n)})}else h(n),g(n)},expect:function(e,t){C(e),t=t||"";var r=this;return{"with":function(u){n={method:e,route:t,expected:u,resource:r},d(n)}}}}}function b(n){var e=[];return{fullRoute:n.fullRoute,regExp:n.regExp,method:n.method,nextResponse:function(n,t){e.push({status:n,data:t})},getSpecialResponse:function(){return e.shift()},hasSpecialResponse:function(){return Boolean(e.length)},getSpecialResponseOr:function(n){if(this.hasSpecialResponse()){var e=this.getSpecialResponse();return[e.status,JSON.stringify(e.data),{},"OK"]}return _.isFunction(n)&&n()}}}function w(n){var e={};return{getAll:function(){return _.map(e)
},create:function(n){S(n);var t=n.id;e[JSON.stringify(t)]=n},find:function(t,r){R(t),r=r||{};var u=e[JSON.stringify(t)];if(!u)throw new Error("No item found in "+n+" table with id of "+t);return r.wrap?F(u,O(n)):u},"delete":function(t){R(t);var t=JSON.stringify(t),r=e[t];if(!r)throw new Error("No item found in "+n+" table with id of "+t+". So can't delete it.");return e[t]=null,r}}}function k(n){var e=Facade.db[n.name];if(!e)throw new Error("There doesnt appear to be a table called "+n.name);return e}function E(n){return k(n).getAll()}function x(n,e,t){return t=t||{},k(n).find(e,t)}function F(n,e){return n=_.extend({},n),n.showUrl=function(){return e.url+"/"+n.id},n}function O(n){var e=Facade.resources[n];if(!e)throw new Error("There doesnt appear to be a resource called "+n);return e}function j(n){if(!_.isString(n.name))throw new Error("You must provide a name for the resource");if(Facade.resources[n.name])throw new Error("A resource named "+n.name+" already exists. Please choose a different name.");if(!_.isString(n.url))throw new Error("You must provide a url for the "+n.name+" resource");var e=_.pluck(Facade.resources,"url");if(_.find(e,function(e){return e===n.url}))throw new Error("The url "+n.url+" is already taken. Please change one")}function S(n){if(!n.id)throw new Error("The resource must have an id property.")}function R(n){if(!n)throw new Error("You must pass in an id to find a record")}function T(n){if(!_.isArray(n))throw new Error("addItems must take an array")}function C(n){if(!_.isString(n))throw new Error("No HTTP method was provided");var e=["GET","POST","PATCH","PUT","HEAD","DELETE"];if(!_.contains(e,n))throw new Error(n+" is not a valid HTTP method.")}function N(n){if(n=n||{},Facade.backend=Facade.backend||n.backend||{},!_.isFunction(Facade.backend.whenGET))throw new Error("$httpBackend not detected. Either add it as an option when initializing, or set the attribute directly on Facade via Facade.backend = $httpBackend")}function A(n){if(_.isRegExp(n))throw new Error("Regex routes can't be used for item routes. Either make 'onItem' false or make the route a string")}function I(n){if(C(n.method),!_.isString(n.route)&&!_.isRegExp(n.route))throw new Error("You must supply a route (eg: '/my_route') as either a string or regex");if(!n.callback)throw new Error("You must supply a response callback for custom routes.")}function D(n){if(!_.isArray(n))throw new Error("Response must be an array");if(4!==n.length)throw new Error("Response does not appear to be in the form of [status, data, headers, status_text]")}window.Facade={};var P,J=!1;Facade.resources={},Facade.db={};var W={},$={},B={},K={},z=[];Facade.resource=function(n){return n=n||{},j(n),this.db[n.name]=w(n.name),W[n.name]={},this.resources[n.name]=y(n)},Facade.initialize=function(t){N(t),J=!0,_.isFunction(P)&&P(),_.each(this.resources,function(n){e(n)}),n()},Facade.reset=function(){Facade.resources=_.clone($,!0),Facade.db=_.clone(B,!0),W=_.clone(K,!0),J=!1},Facade.define=function(n){P=n},Facade.undefine=function(){P=void 0},Facade.clear=function(){this.resources={},this.db={},W={},z=[],this.backend=void 0,J=!1},Facade.findRoute=function(n,e){var t,r=[n,e].join(" "),u=_.any(W,function(u){return t=u[r],t?t:t=_.chain(u).filter("regExp").where({method:n}).find(function(n){return n.regExp.test(e)}).value()});if(!u)throw new Error("The route "+r+" does not exist");return t}}.call(this);